!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):"object"==typeof exports?exports.Slalom=i():t.Slalom=i()}(this,function(){return function(t){function i(e){if(n[e])return n[e].exports;var o=n[e]={exports:{},id:e,loaded:!1};return t[e].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}var n={};return i.m=t,i.c=n,i.p="",i(0)}([function(t,i,n){"use strict";var e={MotionContext:n(4),Manipulator:n(2),MotionConstraint:n(3),Box:n(1),Serialization:n(7)};t.exports=e},function(t){"use strict";function i(t){return Math.round(t*e)/e}function n(t){t&&t.style?this._element=t:(this._element=document.createElement("div"),this._element.className="box",t&&(this._element.textContent=t)),this.x=0,this.y=0,this.right=100,this.bottom=100,this.layoutWidth=-1,this.layoutHeight=-1,this._children=[],this.update()}var e=window.devicePixelRatio;n.prototype.element=function(){return this._element},n.prototype.addChild=function(t){this._children.push(t)},n.prototype.update=function(t,n){function e(t){return t.valueOf?t.valueOf():t}for(var o=e(this.x),r=e(this.y),a=e(this.right),s=e(this.bottom),l=Math.max(0,a-o),u=Math.max(0,s-r),c=0;c<this._children.length;c++)this._children[c].update(o,r);t||(t=0),n||(n=0),o-=t,r-=n;var h=1,p=1;if(-1!=this.layoutWidth&&(h=l/this.layoutWidth,l=this.layoutWidth),-1!=this.layoutHeight&&(p=u/this.layoutHeight,u=this.layoutHeight),1==h&&1==p&&(o=i(o),r=i(r),l=i(l),u=i(u)),l!=this._lastWidth&&(this._lastWidth=l,this._element.style.width=l+"px"),u!=this._lastHeight&&(this._lastHeight=u,this._element.style.height=u+"px"),o!=this._lastX||r!=this._lastY){this._lastX=o,this._lastY=r;var v="translate3D("+o+"px, "+r+"px, 0)";(1!=h||1!=p)&&(v+=" scale("+h+", "+p+")"),this._element.style.webkitTransform=v,this._element.style.transform=v}},t.exports=n},function(t){"use strict";function i(t,i){this._variable=t,this._solver=null,this._axis=i,this._context=null,this._motion=null,this._animation=null,this._name="manipulator-"+t.name+"-"+ ++n,this._hitConstraint=null,this._constraintCoefficient=1,this._motionState={editing:!1,dragging:!1,dragStart:0,dragDelta:0,dragTriggerDelta:0,velocityAnimation:null,velocityAnimationPosition:0,velocityAnimationVelocity:0,constraintAnimation:null,constraintAnimationPosition:0,constraintAnimationVelocity:0,constraintAnimationConstraint:null,trialAnimation:!1}}var n=0;i.prototype.onPan=function(t){if("panstart"==t.type){var i="x"==this._axis?t.deltaX:t.deltaY;this._motionContext.stopOthers(this._variable),this._motionState.dragging=!0,this._motionState.dragStart=this._variable.valueOf(),this._motionState.dragDelta=0,this._motionState.dragTriggerDelta=i,this._update()}else if("panmove"==t.type){var i="x"==this._axis?t.deltaX:t.deltaY;this._motionState.dragDelta=i-this._motionState.dragTriggerDelta,this._update()}else if("panend"==t.type){var n=1e3*-("x"==this._axis?t.velocityX:t.velocityY);this._motionState.dragging=!1,this._motionState.trialAnimation=!0,this._motionContext&&this._motionContext.update(),this._createAnimation(n),this._motionState.trialAnimation=!1}},i.prototype._setMotionContext=function(t){this._motionContext=t,this._solver=t.solver(),this._solver.add(new c.StayConstraint(this._variable,c.Strength.medium,0))},i.prototype.name=function(){return this._name},i.prototype.variable=function(){return this._variable},i.prototype.createMotion=function(t,i){var n=new Gravitas.Friction(.001);return n.set(t,i),n},i.prototype._cancelAnimation=function(t){this._motionState[t]&&(this._motionState[t].cancel(),this._motionState[t]=null)},i.prototype._update=function(){function t(){i._motionState.editing||(i._solver.beginEdit(i._variable,c.Strength.strong),i._motionState.editing=!0)}var i=this;if(this._motionState.dragging){this._cancelAnimation("velocityAnimation"),this._cancelAnimation("constraintAnimation"),this._motionState.velocityAnimationVelocity=0,this._motionState.constraintAnimationVelocity=0,t();var n=this._motionState.dragStart+this._motionState.dragDelta;if(this._hitConstraint){this._solver.suggestValue(this._variable,n);var e=this._hitConstraint.delta()/this._constraintCoefficient;n+=e*this._hitConstraint.overdragCoefficient}this._solver.suggestValue(this._variable,n)}else if(this._motionState.constraintAnimation){this._cancelAnimation("velocityAnimation"),t();var n=this._motionState.constraintAnimationPosition;if(this._solver.suggestValue(this._variable,n),!this._motionState.constraintAnimationConstraint.captive&&0==this._motionState.constraintAnimationConstraint.delta()){var o=this._motionState.constraintAnimationVelocity;this._createAnimation(o)}}else if(this._motionState.velocityAnimation){t();var n=this._motionState.velocityAnimationPosition;this._solver.suggestValue(this._variable,n)}else{if(!this._motionState.editing)return;this._solver.endEdit(this._variable),this._motionState.editing=!1,this._motionState.velocityAnimationVelocity=0,this._motionState.constraintAnimationVelocity=0}this._motionContext&&this._motionContext.update()},i.prototype._createAnimation=function(t){if(!this._motionState.dragging){var i=this;if(this._hitConstraint){if(this._motionState.constraintAnimation){if(this._motionState.constraintAnimationConstraint==this._hitConstraint||this._motionState.constraintAnimationConstraint.captive)return;this._cancelAnimation("constraintAnimation")}this._motionState.constraintAnimationConstraint=this._hitConstraint,t=i._motionState.velocityAnimation?i._motionState.velocityAnimationVelocity:t;var n=this._variable.valueOf();if(i._motionState.velocityAnimation)n=i._motionState.velocityAnimation.model.x(60);else if(t){var e=this.createMotion(this._variable.valueOf(),t);n=e.x(60)}var o=this._motionState.dragStart;if(this._variable!=this._hitConstraint.variable){var r=this._variable.valueOf();this._motionState.editing?(this._solver.suggestValue(this._variable,o),this._solver.solve(),o=this._hitConstraint.variable.valueOf(),this._solver.suggestValue(this._variable,n),this._solver.solve(),n=this._hitConstraint.variable.valueOf(),this._solver.suggestValue(this._variable,r),this._solver.solve()):console.warn("not editing; cannot figure out correct start/end positions for motion constraint")}var a=this._hitConstraint.delta(n,o),s=a/this._constraintCoefficient;this._cancelAnimation("constraintAnimation"),this._cancelAnimation("velocityAnimation");var e=this._hitConstraint.createMotion(this._variable.valueOf());return e.setEnd(this._variable.valueOf()+s,t),void(this._motionState.constraintAnimation=Gravitas.createAnimation(e,function(){i._motionState.constraintAnimationPosition=e.x(),i._motionState.constraintAnimationVelocity=e.dx(),i._update(),e.done()&&(i._cancelAnimation("constraintAnimation"),i._motionState.constraintAnimationConstraint=null,i._update())}))}var e=this.createMotion(this._variable.valueOf(),t);e.done()||(this._cancelAnimation("velocityAnimation"),this._cancelAnimation("constraintAnimation"),this._motionState.velocityAnimation=Gravitas.createAnimation(e,function(){i._motionState.velocityAnimationPosition=e.x(),i._motionState.velocityAnimationVelocity=e.dx(),i._update(),e.done()&&(i._cancelAnimation("velocityAnimation"),i._update(),i._hitConstraint&&i._createAnimation(0))}))}},i.prototype.hitConstraint=function(t,i){return t!=this._hitConstraint?(this._hitConstraint=t,this._constraintCoefficient=i,this._motionState.dragging?void this._update():void(this._motionState.trialAnimation||this._createAnimation())):void 0},i.prototype.hitConstraints=function(t){return 0==t.length?(this._hitConstraint=null,void(this._constraintCoefficient=1)):(t.sort(function(t,i){var n=t.motionConstraint,e=i.motionConstraint;return n.overdragCoefficient==e.overdragCoefficient?Math.abs(i.delta)-Math.abs(t.delta):e.overdragCoefficient-n.overdragCoefficient}),void this.hitConstraint(t[0].motionConstraint,t[0].coefficient,t[0].delta))},i.prototype.animating=function(){return this._motionState.dragging?!1:!!this._motionState.velocityAnimation||this._motionState.trialAnimation},i.prototype.editing=function(){return this._motionState.editing},i.prototype.cancelAnimations=function(){this._cancelAnimation("velocityAnimation"),this._cancelAnimation("constraintAnimation"),this._hitConstraint=null,this._update()},t.exports=i},function(t){"use strict";function i(t,i,e,o){if(this.variable=t,this.value=e,"string"==typeof i)switch(i){case"==":this.op=n.equal;break;case">=":this.op=n.greater;break;case"<=":this.op=n.less;break;case"<":this.op=n.l;break;case">":this.op=n.g;break;case"%":this.op=n.modulo;break;case"||":this.op=n.or}else this.op=i;o||(o={}),this.overdragCoefficient=o.hasOwnProperty("overdragCoefficient")?o.overdragCoefficient:.75,this.physicsModel=o.physicsModel,this.captive=o.captive||!1}var n={greater:function(t,i){return t>=i?0:i-t},less:function(t,i){return i>=t?0:i-t},l:function(t,i){return i>t?0:i-t},g:function(t,i){return t>i?0:i-t},equal:function(t,i){return i-t},modulo:function(t,i,n){var e=i*Math.round(n/i);return e-t},adjacentModulo:function(t,i,e,o){if(void 0===o)return n.modulo(t,i,e);var r=Math.round(o/i),a=Math.round(e/i),s=a-r;s&&(s/=Math.abs(s));var l=(r+s)*i;return l-t},or:function(t,i,n){var e=9007199254740991;if(!Array.isArray(i))return 0;for(var o=e,r=n,a=0;a<i.length;a++){var s=Math.abs(i[a]-n);s>o||(o=s,r=i[a])}return r-t}};i.underDamped=function(){return new Gravitas.Spring(1,200,20)},i.criticallyDamped=function(){return new Gravitas.Spring(1,200,Math.sqrt(800))},i.ops=n,i.prototype.delta=function(t,i){return t||(t=this.variable),this.op(this.variable,this.value,t,i)},i.prototype.createMotion=function(t){var i=this.physicsModel?this.physicsModel():new Gravitas.Spring(1,200,20);return i.snap(t),i},t.exports=i},function(t,i,n){"use strict";function e(){this._solver=new o(new c.SimplexSolver),this._boxes=[],this._motionConstraints=[],this._manipulators=[],this._updating=!1}var o=n(6);e.prototype.solver=function(){return this._solver},e.prototype.addBox=function(t){this._boxes.push(t)},e.prototype.boxes=function(){return this._boxes},e.prototype.addMotionConstraint=function(t){return this._motionConstraints.push(t),t},e.prototype.addManipulator=function(t){return this._manipulators.push(t),t._setMotionContext(this),this.update(),t},e.prototype.update=function(){if(!this._updating){this._updating=!0,this._resolveMotionConstraints();for(var t=0;t<this._boxes.length;t++)this._boxes[t].update();this._updating=!1}},e.prototype._coefficient=function(t,i){var n=this._solver.solver(),e=t.variable(),o=n._editVarMap.get(e);if(!o)return 0;var r=o.editMinus,a=n.rows.get(i);return a?a.coefficientFor(r):0},e.prototype._resolveMotionConstraints=function(){function t(t,i,e,o){var r={motionConstraint:i,coefficient:e,delta:o},a=t.name();n.hasOwnProperty(a)?n[a].violations.push(r):n[a]={manipulator:t,violations:[r]}}function i(){for(var t in n){var i=n[t];i.manipulator.hitConstraints(i.violations)}}for(var n={},e=0;e<this._manipulators.length;e++){var o=this._manipulators[e];n[o.name()]={manipulator:o,violations:[]}}for(var e=0;e<this._motionConstraints.length;e++){var r=this._motionConstraints[e],a=r.delta();if(0!=a)for(var s=0;s<this._manipulators.length;s++){var o=this._manipulators[s];if(0!=a){var l=this._coefficient(o,r.variable);0!=l&&t(o,r,l,a)}}}i()},e.prototype.stopOthers=function(t){for(var i=0;i<this._manipulators.length;i++){var n=this._manipulators[i];0!=this._coefficient(n,t)&&n.cancelAnimations()}},t.exports=e},function(t){t.exports=function(){function t(t,i){function n(){this.constructor=t}n.prototype=i.prototype,t.prototype=new n}function i(t,i,n,e,o,r){this.message=t,this.expected=i,this.found=n,this.offset=e,this.line=o,this.column=r,this.name="SyntaxError"}function n(t){function n(i){function n(i,n,e){var o,r;for(o=n;e>o;o++)r=t.charAt(o),"\n"===r?(i.seenCR||i.line++,i.column=1,i.seenCR=!1):"\r"===r||"\u2028"===r||"\u2029"===r?(i.line++,i.column=1,i.seenCR=!0):(i.column++,i.seenCR=!1)}return pn!==i&&(pn>i&&(pn=0,vn={line:1,column:1,seenCR:!1}),n(vn,pn,i),pn=i),vn}function e(t){dn>cn||(cn>dn&&(dn=cn,fn=[]),fn.push(t))}function o(e,o,r){function a(t){var i=1;for(t.sort(function(t,i){return t.description<i.description?-1:t.description>i.description?1:0});i<t.length;)t[i-1]===t[i]?t.splice(i,1):i++}function s(t,i){function n(t){function i(t){return t.charCodeAt(0).toString(16).toUpperCase()}return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(t){return"\\x0"+i(t)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(t){return"\\x"+i(t)}).replace(/[\u0180-\u0FFF]/g,function(t){return"\\u0"+i(t)}).replace(/[\u1080-\uFFFF]/g,function(t){return"\\u"+i(t)})}var e,o,r,a=new Array(t.length);for(r=0;r<t.length;r++)a[r]=t[r].description;return e=t.length>1?a.slice(0,-1).join(", ")+" or "+a[t.length-1]:a[0],o=i?'"'+n(i)+'"':"end of input","Expected "+e+" but "+o+" found."}var l=n(r),u=r<t.length?t.charAt(r):null;return null!==o&&a(o),new i(null!==e?e:s(o,u),o,u,r,l.line,l.column)}function r(){var t,i,n,e;if(t=cn,i=A(),i!==q){for(n=[],e=a();e!==q;)n.push(e),e=a();n!==q?(e=A(),e!==q?(hn=t,i=B(n),t=i):(cn=t,t=T)):(cn=t,t=T)}else cn=t,t=T;return t}function a(){var t,i,n;return t=cn,i=I(),i!==q?(n=v(),n!==q?(hn=t,i=G(i),t=i):(cn=t,t=T)):(cn=t,t=T),t}function s(){var i;return t.length>cn?(i=t.charAt(cn),cn++):(i=q,0===_n&&e(L)),i}function l(){var i;return X.test(t.charAt(cn))?(i=t.charAt(cn),cn++):(i=q,0===_n&&e(Y)),i===q&&(36===t.charCodeAt(cn)?(i=z,cn++):(i=q,0===_n&&e(Z)),i===q&&(95===t.charCodeAt(cn)?(i=U,cn++):(i=q,0===_n&&e($)))),i}function u(){var i;return i=l(),i===q&&(46===t.charCodeAt(cn)?(i=Q,cn++):(i=q,0===_n&&e(J))),i}function c(){var i,n;return _n++,ti.test(t.charAt(cn))?(i=t.charAt(cn),cn++):(i=q,0===_n&&e(ii)),_n--,i===q&&(n=q,0===_n&&e(K)),i}function h(){var i;return ni.test(t.charAt(cn))?(i=t.charAt(cn),cn++):(i=q,0===_n&&e(ei)),i}function p(){var i,n;return _n++,10===t.charCodeAt(cn)?(i=ri,cn++):(i=q,0===_n&&e(ai)),i===q&&(t.substr(cn,2)===si?(i=si,cn+=2):(i=q,0===_n&&e(li)),i===q&&(13===t.charCodeAt(cn)?(i=ui,cn++):(i=q,0===_n&&e(ci)),i===q&&(8232===t.charCodeAt(cn)?(i=hi,cn++):(i=q,0===_n&&e(pi)),i===q&&(8233===t.charCodeAt(cn)?(i=vi,cn++):(i=q,0===_n&&e(di)))))),_n--,i===q&&(n=q,0===_n&&e(oi)),i}function v(){var i,n,o;return i=cn,n=A(),n!==q?(59===t.charCodeAt(cn)?(o=fi,cn++):(o=q,0===_n&&e(_i)),o!==q?(n=[n,o],i=n):(cn=i,i=T)):(cn=i,i=T),i===q&&(i=cn,n=y(),n!==q?(o=p(),o!==q?(n=[n,o],i=n):(cn=i,i=T)):(cn=i,i=T),i===q&&(i=cn,n=A(),n!==q?(o=d(),o!==q?(n=[n,o],i=n):(cn=i,i=T)):(cn=i,i=T))),i}function d(){var i,n;return i=cn,_n++,t.length>cn?(n=t.charAt(cn),cn++):(n=q,0===_n&&e(L)),_n--,n===q?i=mi:(cn=i,i=T),i}function f(){var t,i;return _n++,t=_(),t===q&&(t=g()),_n--,t===q&&(i=q,0===_n&&e(gi)),t}function _(){var i,n,o,r,a,l;if(i=cn,t.substr(cn,2)===yi?(n=yi,cn+=2):(n=q,0===_n&&e(Ai)),n!==q){for(o=[],r=cn,a=cn,_n++,t.substr(cn,2)===Ci?(l=Ci,cn+=2):(l=q,0===_n&&e(xi)),_n--,l===q?a=mi:(cn=a,a=T),a!==q?(l=s(),l!==q?(a=[a,l],r=a):(cn=r,r=T)):(cn=r,r=T);r!==q;)o.push(r),r=cn,a=cn,_n++,t.substr(cn,2)===Ci?(l=Ci,cn+=2):(l=q,0===_n&&e(xi)),_n--,l===q?a=mi:(cn=a,a=T),a!==q?(l=s(),l!==q?(a=[a,l],r=a):(cn=r,r=T)):(cn=r,r=T);o!==q?(t.substr(cn,2)===Ci?(r=Ci,cn+=2):(r=q,0===_n&&e(xi)),r!==q?(n=[n,o,r],i=n):(cn=i,i=T)):(cn=i,i=T)}else cn=i,i=T;return i}function m(){var i,n,o,r,a,l;if(i=cn,t.substr(cn,2)===yi?(n=yi,cn+=2):(n=q,0===_n&&e(Ai)),n!==q){for(o=[],r=cn,a=cn,_n++,t.substr(cn,2)===Ci?(l=Ci,cn+=2):(l=q,0===_n&&e(xi)),l===q&&(l=h()),_n--,l===q?a=mi:(cn=a,a=T),a!==q?(l=s(),l!==q?(a=[a,l],r=a):(cn=r,r=T)):(cn=r,r=T);r!==q;)o.push(r),r=cn,a=cn,_n++,t.substr(cn,2)===Ci?(l=Ci,cn+=2):(l=q,0===_n&&e(xi)),l===q&&(l=h()),_n--,l===q?a=mi:(cn=a,a=T),a!==q?(l=s(),l!==q?(a=[a,l],r=a):(cn=r,r=T)):(cn=r,r=T);o!==q?(t.substr(cn,2)===Ci?(r=Ci,cn+=2):(r=q,0===_n&&e(xi)),r!==q?(n=[n,o,r],i=n):(cn=i,i=T)):(cn=i,i=T)}else cn=i,i=T;return i}function g(){var i,n,o,r,a,l;if(i=cn,t.substr(cn,2)===bi?(n=bi,cn+=2):(n=q,0===_n&&e(Si)),n!==q){for(o=[],r=cn,a=cn,_n++,l=h(),_n--,l===q?a=mi:(cn=a,a=T),a!==q?(l=s(),l!==q?(a=[a,l],r=a):(cn=r,r=T)):(cn=r,r=T);r!==q;)o.push(r),r=cn,a=cn,_n++,l=h(),_n--,l===q?a=mi:(cn=a,a=T),a!==q?(l=s(),l!==q?(a=[a,l],r=a):(cn=r,r=T)):(cn=r,r=T);o!==q?(r=h(),r===q&&(r=d()),r!==q?(n=[n,o,r],i=n):(cn=i,i=T)):(cn=i,i=T)}else cn=i,i=T;return i}function y(){var t,i;for(t=[],i=c(),i===q&&(i=m(),i===q&&(i=g()));i!==q;)t.push(i),i=c(),i===q&&(i=m(),i===q&&(i=g()));return t}function A(){var t,i;for(t=[],i=c(),i===q&&(i=p(),i===q&&(i=f()));i!==q;)t.push(i),i=c(),i===q&&(i=p(),i===q&&(i=f()));return t}function C(){var t,i;return t=cn,i=b(),i===q&&(i=x()),i!==q&&(hn=t,i=wi(i)),t=i}function x(){var i,n,o;if(i=cn,n=[],Vi.test(t.charAt(cn))?(o=t.charAt(cn),cn++):(o=q,0===_n&&e(Mi)),o!==q)for(;o!==q;)n.push(o),Vi.test(t.charAt(cn))?(o=t.charAt(cn),cn++):(o=q,0===_n&&e(Mi));else n=T;return n!==q&&(hn=i,n=Ei(n)),i=n}function b(){var i,n,o,r,a;return i=cn,n=cn,o=x(),o!==q?(46===t.charCodeAt(cn)?(r=Q,cn++):(r=q,0===_n&&e(J)),r!==q?(a=x(),a!==q?(o=[o,r,a],n=o):(cn=n,n=T)):(cn=n,n=T)):(cn=n,n=T),n!==q&&(hn=i,n=Fi(n)),i=n}function S(){var t,i;return _n++,t=cn,i=w(),i!==q&&(hn=t,i=Pi(i)),t=i,_n--,t===q&&(i=q,0===_n&&e(Oi)),t}function w(){var t,i,n,o;if(_n++,t=cn,i=l(),i!==q){for(n=[],o=u();o!==q;)n.push(o),o=u();n!==q?(hn=t,i=Ri(i,n),t=i):(cn=t,t=T)}else cn=t,t=T;return _n--,t===q&&(i=q,0===_n&&e(Oi)),t}function V(){var i,n,o,r,a,s;return i=cn,n=S(),n!==q&&(hn=i,n=Hi(n)),i=n,i===q&&(i=C(),i===q&&(i=cn,40===t.charCodeAt(cn)?(n=Di,cn++):(n=q,0===_n&&e(Ii)),n!==q?(o=A(),o!==q?(r=I(),r!==q?(a=A(),a!==q?(41===t.charCodeAt(cn)?(s=Ni,cn++):(s=q,0===_n&&e(ki)),s!==q?(hn=i,n=G(r),i=n):(cn=i,i=T)):(cn=i,i=T)):(cn=i,i=T)):(cn=i,i=T)):(cn=i,i=T))),i}function M(){var t,i,n,e;return t=V(),t===q&&(t=cn,i=E(),i!==q?(n=A(),n!==q?(e=M(),e!==q?(hn=t,i=qi(i,e),t=i):(cn=t,t=T)):(cn=t,t=T)):(cn=t,t=T)),t}function E(){var i;return 43===t.charCodeAt(cn)?(i=Wi,cn++):(i=q,0===_n&&e(ji)),i===q&&(45===t.charCodeAt(cn)?(i=Ti,cn++):(i=q,0===_n&&e(Bi)),i===q&&(33===t.charCodeAt(cn)?(i=Gi,cn++):(i=q,0===_n&&e(Li)))),i}function F(){var t,i,n,e,o,r,a,s;if(t=cn,i=M(),i!==q){for(n=[],e=cn,o=A(),o!==q?(r=O(),r!==q?(a=A(),a!==q?(s=M(),s!==q?(o=[o,r,a,s],e=o):(cn=e,e=T)):(cn=e,e=T)):(cn=e,e=T)):(cn=e,e=T);e!==q;)n.push(e),e=cn,o=A(),o!==q?(r=O(),r!==q?(a=A(),a!==q?(s=M(),s!==q?(o=[o,r,a,s],e=o):(cn=e,e=T)):(cn=e,e=T)):(cn=e,e=T)):(cn=e,e=T);n!==q?(hn=t,i=Xi(i,n),t=i):(cn=t,t=T)}else cn=t,t=T;return t}function O(){var i;return 42===t.charCodeAt(cn)?(i=Yi,cn++):(i=q,0===_n&&e(zi)),i===q&&(47===t.charCodeAt(cn)?(i=Zi,cn++):(i=q,0===_n&&e(Ui))),i}function P(){var t,i,n,e,o,r,a,s;if(t=cn,i=F(),i!==q){for(n=[],e=cn,o=A(),o!==q?(r=R(),r!==q?(a=A(),a!==q?(s=F(),s!==q?(o=[o,r,a,s],e=o):(cn=e,e=T)):(cn=e,e=T)):(cn=e,e=T)):(cn=e,e=T);e!==q;)n.push(e),e=cn,o=A(),o!==q?(r=R(),r!==q?(a=A(),a!==q?(s=F(),s!==q?(o=[o,r,a,s],e=o):(cn=e,e=T)):(cn=e,e=T)):(cn=e,e=T)):(cn=e,e=T);n!==q?(hn=t,i=$i(i,n),t=i):(cn=t,t=T)}else cn=t,t=T;return t}function R(){var i;return 43===t.charCodeAt(cn)?(i=Wi,cn++):(i=q,0===_n&&e(ji)),i===q&&(45===t.charCodeAt(cn)?(i=Ti,cn++):(i=q,0===_n&&e(Bi))),i}function H(){var t,i,n,e,o,r,a,s;if(t=cn,i=P(),i!==q){for(n=[],e=cn,o=A(),o!==q?(r=D(),r!==q?(a=A(),a!==q?(s=P(),s!==q?(o=[o,r,a,s],e=o):(cn=e,e=T)):(cn=e,e=T)):(cn=e,e=T)):(cn=e,e=T);e!==q;)n.push(e),e=cn,o=A(),o!==q?(r=D(),r!==q?(a=A(),a!==q?(s=P(),s!==q?(o=[o,r,a,s],e=o):(cn=e,e=T)):(cn=e,e=T)):(cn=e,e=T)):(cn=e,e=T);n!==q?(hn=t,i=Qi(i,n),t=i):(cn=t,t=T)}else cn=t,t=T;return t}function D(){var i;return t.substr(cn,2)===Ji?(i=Ji,cn+=2):(i=q,0===_n&&e(Ki)),i===q&&(t.substr(cn,2)===tn?(i=tn,cn+=2):(i=q,0===_n&&e(nn)),i===q&&(60===t.charCodeAt(cn)?(i=en,cn++):(i=q,0===_n&&e(on)),i===q&&(62===t.charCodeAt(cn)?(i=rn,cn++):(i=q,0===_n&&e(an))))),i}function I(){var i,n,o,r,a,s,l,u;if(i=cn,n=H(),n!==q){for(o=[],r=cn,a=A(),a!==q?(t.substr(cn,2)===sn?(s=sn,cn+=2):(s=q,0===_n&&e(ln)),s!==q?(l=A(),l!==q?(u=H(),u!==q?(a=[a,s,l,u],r=a):(cn=r,r=T)):(cn=r,r=T)):(cn=r,r=T)):(cn=r,r=T);r!==q;)o.push(r),r=cn,a=A(),a!==q?(t.substr(cn,2)===sn?(s=sn,cn+=2):(s=q,0===_n&&e(ln)),s!==q?(l=A(),l!==q?(u=H(),u!==q?(a=[a,s,l,u],r=a):(cn=r,r=T)):(cn=r,r=T)):(cn=r,r=T)):(cn=r,r=T);o!==q?(hn=i,n=un(n,o),i=n):(cn=i,i=T)}else cn=i,i=T;return i}var N,k=arguments.length>1?arguments[1]:{},q={},W={start:r},j=r,T=q,B=function(t){return t},G=function(t){return t},L={type:"any",description:"any character"},X=/^[a-zA-Z]/,Y={type:"class",value:"[a-zA-Z]",description:"[a-zA-Z]"},z="$",Z={type:"literal",value:"$",description:'"$"'},U="_",$={type:"literal",value:"_",description:'"_"'},Q=".",J={type:"literal",value:".",description:'"."'},K={type:"other",description:"whitespace"},ti=/^[\t\x0B\f \xA0\uFEFF]/,ii={type:"class",value:"[\\t\\x0B\\f \\xA0\\uFEFF]",description:"[\\t\\x0B\\f \\xA0\\uFEFF]"},ni=/^[\n\r\u2028\u2029]/,ei={type:"class",value:"[\\n\\r\\u2028\\u2029]",description:"[\\n\\r\\u2028\\u2029]"},oi={type:"other",description:"end of line"},ri="\n",ai={type:"literal",value:"\n",description:'"\\n"'},si="\r\n",li={type:"literal",value:"\r\n",description:'"\\r\\n"'},ui="\r",ci={type:"literal",value:"\r",description:'"\\r"'},hi="\u2028",pi={type:"literal",value:"\u2028",description:'"\\u2028"'},vi="\u2029",di={type:"literal",value:"\u2029",description:'"\\u2029"'},fi=";",_i={type:"literal",value:";",description:'";"'},mi=void 0,gi={type:"other",description:"comment"},yi="/*",Ai={type:"literal",value:"/*",description:'"/*"'},Ci="*/",xi={type:"literal",value:"*/",description:'"*/"'},bi="//",Si={type:"literal",value:"//",description:'"//"'},wi=function(t){return{type:"NumericLiteral",value:t}},Vi=/^[0-9]/,Mi={type:"class",value:"[0-9]",description:"[0-9]"},Ei=function(t){return parseInt(t.join(""))},Fi=function(t){return parseFloat(t.join(""))},Oi={type:"other",description:"identifier"},Pi=function(t){return t},Ri=function(t,i){return t+i.join("")},Hi=function(t){return{type:"Variable",name:t}},Di="(",Ii={type:"literal",value:"(",description:'"("'},Ni=")",ki={type:"literal",value:")",description:'")"'},qi=function(t,i){return{type:"UnaryExpression",operator:t,expression:i}},Wi="+",ji={type:"literal",value:"+",description:'"+"'},Ti="-",Bi={type:"literal",value:"-",description:'"-"'},Gi="!",Li={type:"literal",value:"!",description:'"!"'},Xi=function(t,i){for(var n=t,e=0;e<i.length;e++)n={type:"MultiplicativeExpression",operator:i[e][1],left:n,right:i[e][3]};return n},Yi="*",zi={type:"literal",value:"*",description:'"*"'},Zi="/",Ui={type:"literal",value:"/",description:'"/"'},$i=function(t,i){for(var n=t,e=0;e<i.length;e++)n={type:"AdditiveExpression",operator:i[e][1],left:n,right:i[e][3]};return n},Qi=function(t,i){for(var n=t,e=0;e<i.length;e++)n={type:"Inequality",operator:i[e][1],left:n,right:i[e][3]};return n},Ji="<=",Ki={type:"literal",value:"<=",description:'"<="'},tn=">=",nn={type:"literal",value:">=",description:'">="'},en="<",on={type:"literal",value:"<",description:'"<"'},rn=">",an={type:"literal",value:">",description:'">"'},sn="==",ln={type:"literal",value:"==",description:'"=="'},un=function(t,i){for(var n=t,e=0;e<i.length;e++)n={type:"Equality",operator:i[e][1],left:n,right:i[e][3]};return n},cn=0,hn=0,pn=0,vn={line:1,column:1,seenCR:!1},dn=0,fn=[],_n=0;if("startRule"in k){if(!(k.startRule in W))throw new Error("Can't start parsing from rule \""+k.startRule+'".');j=W[k.startRule]}if(N=j(),N!==q&&cn===t.length)return N;throw N!==q&&cn<t.length&&e({type:"end",description:"end of input"}),o(null,fn,dn)}return t(i,Error),{SyntaxError:i,parse:n}}()},function(t){"use strict";function i(t){this._solver=t,this._editing=!1,this._editVars=[],this._priority=0,this.add=this._solver.add.bind(this._solver),this.solve=this._solver.solve.bind(this._solver),this.resolve=this._solver.resolve.bind(this._solver),this.addConstraint=this._solver.addConstraint.bind(this._solver),this.removeConstraint=this._solver.removeConstraint.bind(this._solver)}i.prototype.solver=function(){return this._solver},i.prototype.beginEdit=function(t,i){var n=this._find(t);return-1!=n?(this._editVars[n].count++,void console.log("multiple edit sessions on "+t.name)):(this._editVars.push({edit:t,strength:i,priority:this._priority++,suggest:null,count:1}),void this._reedit())},i.prototype._find=function(t){for(var i=0;i<this._editVars.length;i++)if(this._editVars[i].edit===t)return i;return-1},i.prototype.endEdit=function(t){var i=this._find(t);return-1==i?void console.warn("cannot end edit on variable that is not being edited"):(this._editVars[i].count--,void(0==this._editVars[i].count&&(this._editVars.splice(i,1),this._reedit())))},i.prototype.suggestValue=function(t,i){if(!this._editing)return void console.warn("cannot suggest value when not editing");var n=this._find(t);return-1==n?void console.warn("cannot suggest value for variable that we are not editing"):(this._editVars[n].suggest=i,void this._solver.suggestValue(t,i).resolve())},i.prototype._reedit=function(){if(this._editing&&(this._solver.endEdit(),this._solver.removeAllEditVars()),this._editing=!1,0==this._editVars.length)return void this._solver.resolve();for(var t=0;t<this._editVars.length;t++){var i=this._editVars[t];this._solver.addEditVar(i.edit,i.strength,i.priority)}this._solver.beginEdit();for(var t=0;t<this._editVars.length;t++){var i=this._editVars[t];i.suggest&&this._solver.suggestValue(i.edit,i.suggest)}this._solver.resolve(),this._editing=!0},t.exports=i},function(t,i,n){"use strict";function e(t){function i(t,n){if(Array.isArray(t))for(var e=0;e<t.length;e++)i(t[e],n);else{var o=new r(t.textContent?t.textContent:"");n.addChild(o),n.element().appendChild(o.element()),d[t.id]=o,o.element().id=t.id,t.className&&(o.element().className=t.className),t.layoutWidth&&(o.layoutWidth=t.layoutWidth),t.layoutHeight&&(o.layoutHeight=t.layoutHeight),t.children&&i(t.children,o)}}function n(t){function i(t,i){return t.hasOwnProperty(i)&&t[i].isExternal?t[i]:(t[i]=new c.Variable({name:i}),t[i])}if(f.hasOwnProperty(t))return f[t];if(-1==t.indexOf("."))return f[t]=new c.Variable({name:t}),f[t];var n=t.split(".",2);if(n.length<2||!d.hasOwnProperty(n[0]))return null;var e=d[n[0]];switch(n[1]){case"left":return i(e,"x");case"right":return i(e,"right");case"top":return i(e,"y");case"bottom":return i(e,"bottom")}return null}function e(t){switch(t.type){case"Inequality":var i="<="==t.operator?c.LEQ:c.GEQ,o=new c.Inequality(e(t.left),i,e(t.right),weak);return v.addConstraint(o),o;case"Equality":var o=new c.Equation(e(t.left),e(t.right),weak);return v.addConstraint(o),o;case"MultiplicativeExpression":var o=c.times(e(t.left),e(t.right));return o;case"AdditiveExpression":var r="+"==t.operator?c.plus:c.minus;return r(e(t.left),e(t.right));case"NumericLiteral":return new c.Expression(t.value);case"Variable":return n(t.name);default:console.log("Unhandled expression to parse: "+t.type)}}function u(t,i,n){var e=new s(t,n),o=new Hammer.Manager(i);return o.add(new Hammer.Pan({direction:"y"==n?Hammer.DIRECTION_VERTICAL:Hammer.DIRECTION_HORIZONTAL})),o.on("panstart panmove panend pancancel",e.onPan.bind(e)),e}var h=new r("");h.element().className="root";var p=new o,v=p.solver(),d={};i(t.box,h),p.addBox(h);for(var f={},_=0;_<t.constraints.length;_++){var m=l.parse(t.constraints[_]);m.map(e)}for(var _=0;_<t.motionConstraints.length;_++){var g=t.motionConstraints[_];p.addMotionConstraint(new a(n(g.lhs),g.op,g.rhs,g.options))}for(var _=0;_<t.manipulators.length;_++){var y=t.manipulators[_];p.addManipulator(u(n(y.variable),d[y.box].element(),y.axis))}return p}var o=n(4),r=n(1),a=n(3),s=n(2),l=n(5);t.exports={assemble:e}}])});